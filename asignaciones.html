<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Asignaciones de la semana (Admin)</title>
  <style>
    body{
      font-family: Arial, sans-serif;
      background:#f0f6ff;
      margin:0;
      padding:24px;
      display:flex;
      justify-content:center;
    
      padding-top:70px; /* deja espacio para el menú */}
    .container{
      width: min(980px, 100%);
      background:#fff;
      border-radius:14px;
      box-shadow:0 12px 40px rgba(0,0,0,.08);
      padding:22px;
    }
    h1{
      margin:0 0 8px 0;
      color:#143d8f;
      font-size:22px;
    }
    .sub{
      margin:0 0 18px 0;
      color:#4b5563;
      font-size:14px;
    }
    .bar{
      display:flex;
      gap:12px;
      flex-wrap:wrap;
      align-items:end;
      margin-bottom:16px;
      padding:12px;
      background:#f7fbff;
      border:1px solid #e6eefb;
      border-radius:12px;
    }
    label{
      font-size:12px;
      color:#374151;
      display:block;
      margin-bottom:6px;
    }
    input, select, textarea{
      width:100%;
      box-sizing:border-box;
      padding:10px;
      border-radius:10px;
      border:1px solid #d1d5db;
      outline:none;
      font-size:14px;
      background:#fff;
    }
    textarea{ min-height: 40px; resize: vertical; }

    .grid{
      display:grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap:14px;
    }
    @media (max-width: 800px){
      .grid{ grid-template-columns: 1fr; }
    }
    .section{
      margin-top:18px;
      padding-top:12px;
      border-top:1px solid #eef2ff;
    }
    .section h2{
      margin:0 0 12px 0;
      font-size:16px;
      color:#1f2937;
    }

    .row{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      align-items:center;
      margin-top:10px;
    }
    .row .btn{
      border:1px solid #c7d2fe;
      background:#eef2ff;
      color:#1e3a8a;
      padding:10px 12px;
      border-radius:10px;
      cursor:pointer;
      font-weight:700;
      font-size:13px;
    }
    .row .btn.primary{
      background:#1a4fa3;
      border-color:#1a4fa3;
      color:#fff;
    }
    .row .btn.danger{
      background:#fff1f2;
      border-color:#fecdd3;
      color:#9f1239;
    }

    .status{
      margin-top:12px;
      padding:10px 12px;
      border-radius:10px;
      background:#f8fafc;
      border:1px solid #e5e7eb;
      color:#111827;
      font-size:13px;
      min-height: 18px;
    }
    .small{
      font-size:12px;
      color:#6b7280;
      margin-top:6px;
    }
  
    /* --- Menú superior --- */
    .topbar{
      position:fixed;
      top:0; left:0;
      width:100%;
      background:#1a4fa3;
      color:#fff;
      display:flex;
      justify-content:space-between;
      align-items:center;
      padding:10px 16px;
      z-index:1000;
      box-shadow:0 2px 10px rgba(0,0,0,0.15);
      box-sizing:border-box;
    }
    .logo{ font-weight:700; font-size:16px; }
    .menu{ display:flex; gap:14px; align-items:center; flex-wrap:wrap; }
    .menu a{ color:#fff; text-decoration:none; font-weight:600; font-size:13px; }
    .menu a.active{ text-decoration:underline; }
    .logout{
      background:#ff4d4d;
      border:none;
      color:#fff;
      padding:6px 12px;
      border-radius:8px;
      cursor:pointer;
      font-weight:700;
      font-size:13px;
    }

    /* Impresión tablero mensual (activado por JS agregando body.print-mes) */
    @media print{
      body.print-mes{ background:#fff; padding:0; }
      body.print-mes .topbar,
      body.print-mes .container > *{ display:none !important; }
      body.print-mes #printMes{ display:block !important; }

      /* Impresión semana (por defecto) */
      body{ background:#fff !important; }
      .topbar, .bar, .no-print{ display:none !important; }
      .container{ box-shadow:none !important; }
      textarea, input, select{ border:1px solid #ddd !important; }
      h1{ margin-top:0; }

    }
  </style>
</head>
<body>
  <nav class="topbar">
  <div class="logo">Villa Fiad</div>
  <div class="menu">
    <a href="index.html" id="navInicio">Inicio</a>
    <a href="asignaciones.html" id="navAsignaciones" class="active">Asignaciones</a>
    <a href="personas.html" id="navPersonas">Personas</a>
    <a href="visitantes.html" id="navVisitantes">Visitantes</a>
    <button type="button" class="logout" id="btnSalir">Salir</button>
  </div>
</nav>
<div class="container">
    <h1>Asignaciones de la semana (Admin)</h1>
    <p class="sub">Cargá, guardá e imprimí las asignaciones semanales. Se guarda en Firestore con “merge” (no borra lo anterior).</p>

    <div class="bar">
      <div style="min-width:230px;">
        <label for="semana">Semana (fecha de referencia)</label>
        <input type="date" id="semana" />
        <div class="small">Sugerencia: elegí el sábado de esa semana.</div>
      </div>

      <div style="min-width:230px; display:flex; gap:8px; align-items:end;">
        <button class="btn" id="btnEstaSemana" title="Ir al sábado de esta semana">Esta semana</button>
        <button class="btn" id="btnSemanaAnterior" title="Semana anterior">◀</button>
        <button class="btn" id="btnSemanaSiguiente" title="Semana siguiente">▶</button>
      </div>

      <div style="min-width:180px;">
        <button class="btn primary" id="btnCargar">Cargar</button>
      </div>

      <div style="min-width:180px;">
        <button class="btn" id="btnLimpiar">Limpiar formulario</button>
      </div>

      <div style="min-width:180px;">
        <button class="btn" id="btnCopiarAnterior">Copiar semana anterior</button>
        <div class="small">Trae los mismos asignados de la semana pasada.</div>
      </div>

      <div style="min-width:180px;">
        <button class="btn primary" id="btnGuardar">Guardar</button>
      </div>

      <div style="min-width:180px;">
        <button class="btn" id="btnPdfPresidente">PDF Presidente</button>
      </div>

      <div style="min-width:180px;">
        <button class="btn" id="btnImprimir">Imprimir</button>
      </div>

      <div style="min-width:180px;">
        <button class="btn" id="btnGenerarAviso">Generar aviso semanal</button>
      </div>

      <div style="min-width:180px;">
        <button class="btn" id="btnCopiarAviso">Copiar aviso</button>
      </div>

      <div style="min-width:180px;">
        <button class="btn" id="btnWhatsappAviso">WhatsApp Web</button>
      </div>
    </div>

    <div class="section">
      <h2>Programa</h2>
      <div class="grid">
        <div>
          <label for="presidente">Presidente</label>
          <select id="presidente"></select>
        </div>

        <div>
          <label for="cancionNumero">Canción (número)</label>
          <input id="cancionNumero" type="text" placeholder="Ej: 23" />
        </div>

        <div>
          <label for="oracionInicial">Oración inicial</label>
          <select id="oracionInicial"></select>
        </div>

        <div>
          <label for="oradorPublico">Orador público</label>
          <input id="oradorPublico" type="text" list="listaOradoresVisitantes" placeholder="Nombre del orador (visitante)" />
          <datalist id="listaOradoresVisitantes"></datalist>
        </div>

        <div>
          <label for="congregacionVisitante">De qué congregación nos visita</label>
          <input id="congregacionVisitante" type="text" placeholder="Ej: Santa Rosa" />
        </div>

        <div>
          <label for="tituloDiscurso">Título del discurso</label>
          <textarea id="tituloDiscurso" placeholder="Ej: ‘Mantengamos la fe…’"></textarea>
        </div>

        <div>
          <label for="tituloSiguienteSemana">Título de la siguiente semana</label>
          <textarea id="tituloSiguienteSemana" placeholder="Ej: ‘La amistad con Jehová…’"></textarea>
        </div>

        <div>
          <label for="conductorAtalaya">Conductor Atalaya</label>
          <select id="conductorAtalaya"></select>
          <div class="row">
            <button class="btn" id="btnSugerirConductor">Sugerir conductor</button>
          </div>
          <div class="small">
            Orden: Marcelo Palavecino → Leonardo Araya → cualquier anciano → Marcelo Rodríguez → Eduardo Rivadeneira.
          </div>
        </div>

        <div>
          <label for="lectorAtalaya">Lector de Atalaya</label>
          <select id="lectorAtalaya"></select>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Multimedia</h2>
      <div class="grid">
        <div>
          <label for="multimedia1">Multimedia 1</label>
          <select id="multimedia1"></select>
        </div>
        <div>
          <label for="multimedia2">Multimedia 2</label>
          <select id="multimedia2"></select>
        </div>
        <div>
          <label for="plataforma">Plataforma</label>
          <select id="plataforma"></select>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Acomodadores</h2>
      <div class="grid">
<div>
          <label for="acomodadorEntrada">Acomodador entrada</label>
          <select id="acomodadorEntrada"></select>
        </div>
        <div>
          <label for="acomodadorAuditorio">Acomodador auditorio</label>
          <select id="acomodadorAuditorio"></select>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Microfonistas</h2>
      <div class="grid">
        <div>
          <label for="microfonista1">Microfonista 1</label>
          <select id="microfonista1"></select>
        </div>
        <div>
          <label for="microfonista2">Microfonista 2</label>
          <select id="microfonista2"></select>
        </div>
      </div>
    </div>

    <div class="section">
      <h2>Cierre</h2>
      <div class="grid">
        <div>
          <label for="oracionFinal">Oración final</label>
          <input id="oracionFinal" type="text" list="listaOracionFinal" placeholder="Nombre (orador/presidente/u otro)" />
          <datalist id="listaOracionFinal"></datalist>

          <div class="row">
            <button class="btn" id="btnOracionFinalOrador">Usar orador público</button>
            <button class="btn" id="btnOracionFinalPresidente">Usar presidente</button>
          </div>
          <div class="small">
            Generalmente la hace el orador público; si no se queda, presidente u otro hermano.
          </div>
        </div>
      </div>
    </div>

    <div class="status" id="status"></div>

    <div class="section">
      <h2>Aviso semanal (para enviar el lunes)</h2>
      <p class="sub" style="margin:-6px 0 12px 0;">
        Generá el texto con acomodadores y multimedia para la semana (jueves y sábado). Podés copiarlo o abrir WhatsApp Web con el mensaje listo.
      </p>
      <textarea id="avisoText" placeholder="Acá aparecerá el aviso…" style="width:100%; min-height:120px;"></textarea>
      <div class="small">Tip: en “Semana”, elegí el sábado de esa semana para que el jueves y sábado queden bien.</div>
    </div>

    <div class="section">
      <h2>Asignaciones mensuales (tablero)</h2>
      <p class="sub" style="margin: -6px 0 12px 0;">
        Cargá los asignados por mes. Abajo se completa la hoja lista para imprimir y poner en el tablero.
      </p>

      <div class="bar" style="margin-top:0;">
        <div style="min-width:230px;">
          <label for="mes">Mes</label>
          <input type="month" id="mes" />
        </div>
        <div style="min-width:180px;">
          <button class="btn primary" id="btnCargarMes">Cargar mes</button>
        </div>
        <div style="min-width:180px;">
          <button class="btn primary" id="btnGuardarMes">Guardar mes</button>
        </div>
        <div style="min-width:180px;">
          <button class="btn" id="btnImprimirMes">Imprimir tablero</button>
        </div>
      </div>

      <div class="grid">
        <div>
          <label for="mesPlataforma">Plataforma</label>
          <select id="mesPlataforma"></select>
        </div>
        <div>
          <label for="mesAcomodadorEntrada">Acomodador entrada</label>
          <select id="mesAcomodadorEntrada"></select>
        </div>
        <div>
          <label for="mesAcomodadorAuditorio">Acomodador auditorio</label>
          <select id="mesAcomodadorAuditorio"></select>
        </div>
        <div>
          <label for="mesMultimedia1">Multimedia 1</label>
          <select id="mesMultimedia1"></select>
        </div>
        <div>
          <label for="mesMultimedia2">Multimedia 2</label>
          <select id="mesMultimedia2"></select>
        </div>
        <div>
          <label for="mesMicrofonista1">Microfonista 1</label>
          <select id="mesMicrofonista1"></select>
        </div>
        <div>
          <label for="mesMicrofonista2">Microfonista 2</label>
          <select id="mesMicrofonista2"></select>
        </div>
      </div>

      <div id="printMes" style="margin-top:14px;">
        <!-- Vista previa imprimible (se completa con JS) -->
      </div>
    </div>

  </div>

  <script type="module" src="js/pages/asignaciones.js"></script>
</body>
</html>